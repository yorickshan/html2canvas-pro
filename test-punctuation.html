<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中文标点符号测试</title>
    <style>
        body {
            padding: 20px;
            font-family: "Microsoft YaHei", "SimSun", sans-serif;
        }
        .test-case {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ccc;
        }
        .test-text {
            font-size: 24px;
            line-height: 1.5;
        }
        .result {
            margin-top: 20px;
            border: 1px solid #999;
        }
    </style>
</head>
<body>
    <h1>中文标点符号错位测试</h1>
    
    <div class="test-case">
        <h3>测试1：连续中文标点符号</h3>
        <div class="test-text" id="test1">
            《他的故事》《传世不朽》（收到的方式）
        </div>
        <canvas class="result" id="canvas1"></canvas>
    </div>

    <div class="test-case">
        <h3>测试2：混合中文标点和文字</h3>
        <div class="test-text" id="test2">
            「你好」、「世界」、「测试」——这些都是中文标点。
        </div>
        <canvas class="result" id="canvas2"></canvas>
    </div>

    <div class="test-case">
        <h3>测试3：带 letter-spacing 的中文标点</h3>
        <div class="test-text" id="test3" style="letter-spacing: 2px;">
            测试，，，连续标点。。。问题！！！
        </div>
        <canvas class="result" id="canvas3"></canvas>
    </div>

    <script src="dist/html2canvas-pro.js"></script>
    <script>
        async function runTest(elementId, canvasId) {
            const element = document.getElementById(elementId);
            const canvas = await html2canvas(element, {
                logging: true,
                scale: 2
            });
            const resultCanvas = document.getElementById(canvasId);
            resultCanvas.width = canvas.width;
            resultCanvas.height = canvas.height;
            const ctx = resultCanvas.getContext('2d');
            ctx.drawImage(canvas, 0, 0);
        }

        window.addEventListener('load', async () => {
            await runTest('test1', 'canvas1');
            await runTest('test2', 'canvas2');
            await runTest('test3', 'canvas3');
        });
    </script>
</body>
</html>

